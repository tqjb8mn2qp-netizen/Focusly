<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Primary Meta Tags -->
    <title>Study Buddy - Smart Student Planner & Study Timer</title>
    <meta name="title" content="Study Buddy - Smart Student Planner & Study Timer">
    <meta name="description" content="A comprehensive student productivity app to organize school life, study efficiently, and stay motivated. Features: Pomodoro timer, assignment tracker, grade calculator, study streaks, and more!">
    <meta name="keywords" content="study app, student planner, pomodoro timer, homework tracker, grade calculator, study timer, student productivity, focus timer, assignment organizer">
    <meta name="author" content="Study Buddy">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://8000-immk5r2z04fqu7byp66c2-0e616f0a.sandbox.novita.ai/">
    <meta property="og:title" content="Study Buddy - Smart Student Planner & Study Timer">
    <meta property="og:description" content="Organize school life, track assignments, calculate grades, and boost productivity with Pomodoro timers and study streaks. Perfect for students!">
    <meta property="og:image" content="https://8000-immk5r2z04fqu7byp66c2-0e616f0a.sandbox.novita.ai/icon-512.png">
    <meta property="og:image:width" content="512">
    <meta property="og:image:height" content="512">
    <meta property="og:site_name" content="Study Buddy">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://8000-immk5r2z04fqu7byp66c2-0e616f0a.sandbox.novita.ai/">
    <meta property="twitter:title" content="Study Buddy - Smart Student Planner">
    <meta property="twitter:description" content="The ultimate student productivity app with timers, planners, and grade tracking!">
    <meta property="twitter:image" content="https://8000-immk5r2z04fqu7byp66c2-0e616f0a.sandbox.novita.ai/icon-512.png">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Study Buddy">
    <meta name="application-name" content="Study Buddy">
    <meta name="msapplication-TileColor" content="#4A90E2">
    <meta name="msapplication-TileImage" content="/icon-144.png">
    <meta name="theme-color" content="#4A90E2">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icon-16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icon-152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icon-144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icon-120.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icon-114.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icon-76.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icon-72.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icon-60.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/icon-57.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://8000-immk5r2z04fqu7byp66c2-0e616f0a.sandbox.novita.ai/">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="auth-styles.css">
    
    <!-- Security Headers -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://accounts.google.com https://appleid.apple.com; img-src 'self' data: blob: https:; frame-src https://accounts.google.com https://appleid.apple.com;">

</head>
<body>
    <!-- Responsive wrapper: fullscreen app for all devices -->
    <div id="app-wrapper" class="fullscreen-app">
        <div class="phone-screen">
            <!-- Status Bar -->
            <div class="status-bar">
                <span class="time">9:41</span>
                <div class="status-icons">
                    <span class="signal">üì∂</span>
                    <span class="battery">üîã</span>
                </div>
            </div>

            <!-- Main Content Container -->
            <div id="app-container">
                <!-- Screens will be dynamically loaded here -->
            </div>

            <!-- Quick Add FAB -->
            <button class="fab" onclick="app.showQuickAddMenu()" title="Quick Add">
                ‚ûï
            </button>

            <!-- Bottom Navigation -->
            <nav class="bottom-nav">
                <button class="nav-item active" data-screen="dashboard">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-label">Home</span>
                </button>
                <button class="nav-item" data-screen="study">
                    <span class="nav-icon">‚è±Ô∏è</span>
                    <span class="nav-label">Study</span>
                </button>
                <button class="nav-item" data-screen="tasks">
                    <span class="nav-icon">‚úÖ</span>
                    <span class="nav-label">Tasks</span>
                </button>
                <button class="nav-item" data-screen="grades">
                    <span class="nav-icon">üéì</span>
                    <span class="nav-label">Grades</span>
                </button>
                <button class="nav-item" data-screen="stats">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Stats</span>
                </button>
                <button class="nav-item" data-screen="profile">
                    <span class="nav-icon">üë§</span>
                    <span class="nav-label">Profile</span>
                </button>
            </nav>
        </div>
    </div>

    <!-- Demo Controls (hidden in production) -->
    <div class="demo-controls" style="display: none;">
        <h2>üéì Study Buddy Interactive Demo</h2>
        <p>Navigate using the bottom menu or click on interactive elements</p>
        <div class="feature-highlights">
            <div class="highlight-card">
                <span class="highlight-icon">üìö</span>
                <h3>Smart Planner</h3>
                <p>Organize classes & assignments</p>
            </div>
            <div class="highlight-card">
                <span class="highlight-icon">‚è±Ô∏è</span>
                <h3>Focus Timer</h3>
                <p>Pomodoro study sessions</p>
            </div>
            <div class="highlight-card">
                <span class="highlight-icon">üî•</span>
                <h3>Streaks</h3>
                <p>Build consistent habits</p>
            </div>
            <div class="highlight-card">
                <span class="highlight-icon">üìä</span>
                <h3>Analytics</h3>
                <p>Track your progress</p>
            </div>
        </div>
        <button id="reset-demo" class="reset-btn">üîÑ Reset Demo</button>
    </div>

    <!-- Device detector script (runs before app.js) -->
    <script>
        // Device Detection and Responsive Layout Handler
        class DeviceDetector {
            constructor() {
                this.deviceType = this.detectDeviceType();
                this.screenSize = this.getScreenSize();
                this.orientation = this.getOrientation();
                this.init();
            }

            detectDeviceType() {
                const ua = navigator.userAgent.toLowerCase();
                const width = window.innerWidth;
                
                // Check user agent for mobile/tablet
                const isMobile = /iphone|ipod|android|blackberry|opera mini|windows phone/i.test(ua);
                const isTablet = /ipad|android(?!.*mobile)|tablet|kindle|silk/i.test(ua);
                
                // Also check screen width as fallback
                if (isMobile || width < 768) {
                    return 'mobile';
                } else if (isTablet || (width >= 768 && width < 1024)) {
                    return 'tablet';
                } else {
                    return 'desktop';
                }
            }

            getScreenSize() {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                return {
                    width,
                    height,
                    aspectRatio: (width / height).toFixed(2),
                    isSmall: width < 375,
                    isMedium: width >= 375 && width < 768,
                    isLarge: width >= 768
                };
            }

            getOrientation() {
                return window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
            }

            init() {
                // Add device class to body
                document.body.classList.add(`device-${this.deviceType}`);
                document.body.classList.add(`orientation-${this.orientation}`);
                
                // Apply responsive layout
                this.applyResponsiveLayout();
                
                // Listen for resize and orientation changes
                window.addEventListener('resize', () => this.handleResize());
                window.addEventListener('orientationchange', () => this.handleOrientationChange());
                
                // Log device info
                console.log('üì± Device Detected:', {
                    type: this.deviceType,
                    screen: this.screenSize,
                    orientation: this.orientation,
                    userAgent: navigator.userAgent
                });
            }

            applyResponsiveLayout() {
                const wrapper = document.getElementById('app-wrapper');
                const demoControls = document.querySelector('.demo-controls');
                
                // Production mode: always fullscreen, no demo controls
                wrapper.classList.remove('phone-frame', 'tablet-app');
                wrapper.classList.add('fullscreen-app');
                if (demoControls) demoControls.style.display = 'none';
                
                // Update status bar time to real time on all devices
                this.updateRealTime();
            }

            updateRealTime() {
                const updateTime = () => {
                    const now = new Date();
                    const hours = now.getHours();
                    const minutes = now.getMinutes();
                    const timeString = `${hours}:${minutes.toString().padStart(2, '0')}`;
                    const timeElement = document.querySelector('.status-bar .time');
                    if (timeElement) {
                        timeElement.textContent = timeString;
                    }
                };
                
                updateTime();
                setInterval(updateTime, 60000); // Update every minute
            }

            handleResize() {
                this.screenSize = this.getScreenSize();
                this.deviceType = this.detectDeviceType();
                
                // Remove old classes
                document.body.classList.remove('device-mobile', 'device-tablet', 'device-desktop');
                
                // Add new class
                document.body.classList.add(`device-${this.deviceType}`);
                
                // Reapply layout
                this.applyResponsiveLayout();
            }

            handleOrientationChange() {
                setTimeout(() => {
                    this.orientation = this.getOrientation();
                    document.body.classList.remove('orientation-portrait', 'orientation-landscape');
                    document.body.classList.add(`orientation-${this.orientation}`);
                    console.log('üì± Orientation changed to:', this.orientation);
                }, 200);
            }

            getDeviceInfo() {
                return {
                    type: this.deviceType,
                    screen: this.screenSize,
                    orientation: this.orientation,
                    isTouchDevice: 'ontouchstart' in window,
                    pixelRatio: window.devicePixelRatio || 1
                };
            }
        }

        // Initialize device detector immediately
        const deviceDetector = new DeviceDetector();
        window.deviceDetector = deviceDetector; // Make available globally
    </script>

    <!-- Authentication & App Scripts -->
    <script src="auth.js"></script>
    <script src="auth-ui.js"></script>
    <script src="app.js"></script>
    
    <!-- Initialize Authentication -->
    <script>
        // Initialize Auth Manager
        const authManager = new AuthManager();
        window.authManager = authManager;
        
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Auth UI
            authUI = new AuthUI(authManager, window.app);
            window.authUI = authUI;
            
            // Check if user is authenticated
            if (!authManager.isAuthenticated()) {
                console.log('[Auth] User not authenticated, showing sign-in screen');
                authUI.showAuthScreen();
            } else {
                console.log('[Auth] User authenticated:', authManager.getUser().email);
            }
        });
    </script>
</body>
</html>
